### author webber (web-ber12@yandex.ru)


### набор evoSearch - индексирование и поиск с учетом морфологии (версия 0.1)

### содержит:
- плагин evoSearch - для индексирования (в настоящий момент индексации по TV не производится, индексируются только pagetitle,longtitle,description,introtext.content)
- сниппет evoSearch - для вывода результатов поиска. В качестве "рабочей лошадки" вывода используется сниппет DocLister (но можно использовать и Ditto, указав параметр &worker=`Ditto` -  результаты поиска могут быть чуть хуже)
- идея использования phpMorphy - http://valera.ws/2007.09.05~morpho_search_in_mysql/


### обязательные дополнительные компоненты (без их установки решение не работает либо работает хуже):
- сниппет DocLister

### установка
 1. создаем два поля с типом mediumtext в таблице site_content - content_with_tv и content_with_tv_index для хранения оригинала текста  (из поля контента) плюс нужных значений тв и их словоформ 
 2. создаем индекс 
 ALTER TABLE `modx_site_content` ADD FULLTEXT `content_index` (`content_with_tv`, `content_with_tv_index`);
 3. создаем еще один индекс
 ALTER TABLE `modx_site_content` ADD FULLTEXT(`pagetitle`);
 4. устанавливаем плагин и сниппет. Для плагина событие onDocFormSave, 
 параметры  - &offset=Первая строка переиндексации;text;0 &rowsperonce=Строк за сеанс индексировать;text;1 &reindex=Переиндексировать все;text;0 &excludeTmpls=Исключить шаблоны;text; &excludeIDs=Исключить ID ресурсов;text; &TvNames=Имена TV для поиска;text; &unpublished=Индексировать неопубликованные;text;0 &deleted=Индексировать удаленные;text;0 &dicts=Использовать словари;text;rus,eng

при первом запуске или необходимости переиндексации необходимо выставить параметр "Переиндексировать все" = 1, начальные строки и количество строк за сеанс устанавливаются в зависимости от 
возможностей вашего хостинга (например 0 и 10 000 соответственно - проиндексирует строки с 0 в количестве 10 000 штук в БД
необходимо открыть и пересохранить любой документ для создания события onDocFormSave

для последующей работы установите "Переиндексировать все" = 0, "Строк за сеанс индексировать" = 1 
при этом происходит переиндксация только того документа, который сохраняется

### пример вызова
    для вывода результатов [!evoSearch? &tpl=`evoSearch`!], где все параметры - дублируют параметры вызова DocLister
    + параметр noResult - строка, которая выводится при отсутствии результата поиска
    обрабатывает $_GET['search'] в качестве входной строки для поиска 
   
### информация. 
    Т.к. при полнотекстовом поиске MySQL без дополнительных настроект обрабатываются только слова не короче 4 символов, для улучшения результатов поиска используется дополнительный поиск 
    средствами фильтров DocLister (что улучшает результаты, особенно при их отстутствии в результате обычного поиска).
